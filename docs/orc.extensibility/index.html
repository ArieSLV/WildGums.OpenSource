<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.25.1" />
    <meta name="description" content="">


    <title>Orc.Extensibility :: WildGums open source center</title>
    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
    <link href="/css/nucleus.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/hybrid.css" rel="stylesheet">
    <link href="/css/featherlight.min.css" rel="stylesheet">
    <link href="/css/auto-complete.css" rel="stylesheet">
    
    <link href="/css/theme.css" rel="stylesheet">
    
    
    <link href="/css/theme-customization.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <script src="/js/jquery-2.x.min.js"></script>
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left {
        display:none !important;
      }
    </style>

    

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-25600919-4', 'auto');
  ga('send', 'pageview');

</script>
  </head>
  <body class="" data-url="/orc.extensibility/">
    
    <li data-nav-id="/orc.analytics/" class="dd-item">
      <a href="/orc.analytics/">
        <span>Orc.Analytics</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.automaticsupport/" class="dd-item">
      <a href="/orc.automaticsupport/">
        <span>Orc.AutomaticSupport</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.commandline/" class="dd-item">
      <a href="/orc.commandline/">
        <span>Orc.CommandLine</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/" class="dd-item">
      <a href="/orc.controls/">
        <span>Orc.Controls</span><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </a>
        <ul>
    <li data-nav-id="/orc.controls/animatedgif/" class="dd-item">
      <a href="/orc.controls/animatedgif/">
        <span>AnimatedGif</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/bindablerichtextbox/" class="dd-item">
      <a href="/orc.controls/bindablerichtextbox/">
        <span>BindableRichTextBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/colorlegend/" class="dd-item">
      <a href="/orc.controls/colorlegend/">
        <span>ColorLegend</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/colorpicker/" class="dd-item">
      <a href="/orc.controls/colorpicker/">
        <span>ColorPicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/connectionstringbuilder/" class="dd-item">
      <a href="/orc.controls/connectionstringbuilder/">
        <span>ConnectionStringBuilder</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/culturepicker/" class="dd-item">
      <a href="/orc.controls/culturepicker/">
        <span>CulturePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/datepicker/" class="dd-item">
      <a href="/orc.controls/datepicker/">
        <span>DatePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/daterangepicker/" class="dd-item">
      <a href="/orc.controls/daterangepicker/">
        <span>DateRangePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/datetimepicker/" class="dd-item">
      <a href="/orc.controls/datetimepicker/">
        <span>DateTimePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/dbproviderpicker/" class="dd-item">
      <a href="/orc.controls/dbproviderpicker/">
        <span>DbProviderPicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/directorypicker/" class="dd-item">
      <a href="/orc.controls/directorypicker/">
        <span>DirectoryPicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/dropdownbutton/" class="dd-item">
      <a href="/orc.controls/dropdownbutton/">
        <span>DropDownButton</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/expander/" class="dd-item">
      <a href="/orc.controls/expander/">
        <span>Expander</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/filterbox/" class="dd-item">
      <a href="/orc.controls/filterbox/">
        <span>FilterBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/frameratecounter/" class="dd-item">
      <a href="/orc.controls/frameratecounter/">
        <span>FramerateCounter</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/headerbar/" class="dd-item">
      <a href="/orc.controls/headerbar/">
        <span>HeaderBar</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/linklabel/" class="dd-item">
      <a href="/orc.controls/linklabel/">
        <span>LinkLabel</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/listtextbox/" class="dd-item">
      <a href="/orc.controls/listtextbox/">
        <span>ListTextBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/logviewer/" class="dd-item">
      <a href="/orc.controls/logviewer/">
        <span>LogViewer</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/numerictextbox/" class="dd-item">
      <a href="/orc.controls/numerictextbox/">
        <span>NumericTextBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/openfilepicker/" class="dd-item">
      <a href="/orc.controls/openfilepicker/">
        <span>OpenFilePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/pinnabletooltips/" class="dd-item">
      <a href="/orc.controls/pinnabletooltips/">
        <span>PinnableTooltips</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/savefilepicker/" class="dd-item">
      <a href="/orc.controls/savefilepicker/">
        <span>SaveFilePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/stackgrid/" class="dd-item">
      <a href="/orc.controls/stackgrid/">
        <span>StackGrid</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/tabcontrol/" class="dd-item">
      <a href="/orc.controls/tabcontrol/">
        <span>TabControl</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/timespanpicker/" class="dd-item">
      <a href="/orc.controls/timespanpicker/">
        <span>TimeSpanPicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/validationcontextcontrol/" class="dd-item">
      <a href="/orc.controls/validationcontextcontrol/">
        <span>ValidationContextControl</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/watermarktextbox/" class="dd-item">
      <a href="/orc.controls/watermarktextbox/">
        <span>WatermarkTextBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/orc.csvhelper/" class="dd-item">
      <a href="/orc.csvhelper/">
        <span>Orc.CsvHelper</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.csvtexteditor/" class="dd-item">
      <a href="/orc.csvtexteditor/">
        <span>Orc.CsvTextEditor</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.dbtocsv/" class="dd-item">
      <a href="/orc.dbtocsv/">
        <span>Orc.DbToCsv</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.dependencygraph/" class="dd-item">
      <a href="/orc.dependencygraph/">
        <span>Orc.DependencyGraph</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.dynamicobjects/" class="dd-item">
      <a href="/orc.dynamicobjects/">
        <span>Orc.DynamicObjects</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.entityframework/" class="dd-item">
      <a href="/orc.entityframework/">
        <span>Orc.EntityFramework</span><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/orc.entityframework/using-the-dbcontextmanager/" class="dd-item">
        <a href="/orc.entityframework/using-the-dbcontextmanager/">
          <span>Using the DbContextManager</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.entityframework/using-the-repositories-and-unit-of-work/" class="dd-item">
        <a href="/orc.entityframework/using-the-repositories-and-unit-of-work/">
          <span>Using the repositories and unit of work</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.entityframework/using-stored-procedures-and-functions/" class="dd-item">
        <a href="/orc.entityframework/using-stored-procedures-and-functions/">
          <span>Using stored procedures and functions</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.entityframework/using-the-modelbase-as-base-class-for-code-first-entities/" class="dd-item">
        <a href="/orc.entityframework/using-the-modelbase-as-base-class-for-code-first-entities/">
          <span>Using the ModelBase as base class for code-first entities</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/orc.extensibility/" class="dd-item parent active">
      <a href="/orc.extensibility/">
        <span>Orc.Extensibility</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.feedback/" class="dd-item">
      <a href="/orc.feedback/">
        <span>Orc.Feedback</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.fileassociation/" class="dd-item">
      <a href="/orc.fileassociation/">
        <span>Orc.FileAssociation</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.filesystem/" class="dd-item">
      <a href="/orc.filesystem/">
        <span>Orc.FileSystem</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.filterbuilder/" class="dd-item">
      <a href="/orc.filterbuilder/">
        <span>Orc.FilterBuilder</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.fluentvalidation/" class="dd-item">
      <a href="/orc.fluentvalidation/">
        <span>Orc.FluentValidation</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.licensemanager/" class="dd-item">
      <a href="/orc.licensemanager/">
        <span>Orc.LicenseManager</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.logviewer/" class="dd-item">
      <a href="/orc.logviewer/">
        <span>Orc.LogViewer</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.memento/" class="dd-item">
      <a href="/orc.memento/">
        <span>Orc.Memento</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.metadata/" class="dd-item">
      <a href="/orc.metadata/">
        <span>Orc.Metadata</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.notifications/" class="dd-item">
      <a href="/orc.notifications/">
        <span>Orc.Notifications</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.nugetexplorer/" class="dd-item">
      <a href="/orc.nugetexplorer/">
        <span>Orc.NuGetExplorer</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.prism/" class="dd-item">
      <a href="/orc.prism/">
        <span>Orc.Prism</span><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/orc.prism/using-the-bootstrapper/" class="dd-item">
        <a href="/orc.prism/using-the-bootstrapper/">
          <span>Using the bootstrapper</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.prism/declaring-modules/" class="dd-item">
        <a href="/orc.prism/declaring-modules/">
          <span>Declaring modules</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
    <li data-nav-id="/orc.prism/module-catalogs/" class="dd-item">
      <a href="/orc.prism/module-catalogs/">
        <span>Module Catalogs</span><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/orc.prism/module-catalogs/compositemodulecatalog/" class="dd-item">
        <a href="/orc.prism/module-catalogs/compositemodulecatalog/">
          <span>CompositeModuleCatalog</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.prism/module-catalogs/downloadingmodulecatalog/" class="dd-item">
        <a href="/orc.prism/module-catalogs/downloadingmodulecatalog/">
          <span>DownloadingModuleCatalog</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.prism/module-catalogs/nugetbasedmodulecatalog/" class="dd-item">
        <a href="/orc.prism/module-catalogs/nugetbasedmodulecatalog/">
          <span>NuGetBasedModuleCatalog</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.prism/module-catalogs/safedirectorymodulecatalog/" class="dd-item">
        <a href="/orc.prism/module-catalogs/safedirectorymodulecatalog/">
          <span>SafeDirectoryModuleCatalog</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
        </ul>
    </li>
      <li data-nav-id="/orc.prism/translating-or-customizing/" class="dd-item">
        <a href="/orc.prism/translating-or-customizing/">
          <span>Translating or customizing</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/orc.projectmanagement/" class="dd-item">
      <a href="/orc.projectmanagement/">
        <span>Orc.ProjectManagement</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.scheduling/" class="dd-item">
      <a href="/orc.scheduling/">
        <span>Orc.Scheduling</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.search/" class="dd-item">
      <a href="/orc.search/">
        <span>Orc.Search</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.skia/" class="dd-item">
      <a href="/orc.skia/">
        <span>Orc.Skia</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.snapshots/" class="dd-item">
      <a href="/orc.snapshots/">
        <span>Orc.Snapshots</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.sort/" class="dd-item">
      <a href="/orc.sort/">
        <span>Orc.Sort</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.squirrel/" class="dd-item">
      <a href="/orc.squirrel/">
        <span>Orc.Squirrel</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.supportpackage/" class="dd-item">
      <a href="/orc.supportpackage/">
        <span>Orc.SupportPackage</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.systeminfo/" class="dd-item">
      <a href="/orc.systeminfo/">
        <span>Orc.SystemInfo</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.wizard/" class="dd-item">
      <a href="/orc.wizard/">
        <span>Orc.Wizard</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.workspacemanagement/" class="dd-item">
      <a href="/orc.workspacemanagement/">
        <span>Orc.WorkspaceManagement</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orchestra/" class="dd-item">
      <a href="/orchestra/">
        <span>Orchestra</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>



        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
        
          <div id="top-bar">
            
              
              
              
            <div id="top-github-link">
              <a class="github-link" href="https://github.com/wildgums/wildgums.opensource/edit/master/src/content/orc.extensibility/_index.md" target="blank">
                <i class="fa fa-code-fork"></i>
                Edit page
              </a>
            </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                <span id="sidebar-toggle-span">
                  <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                    <i class="fa fa-bars"></i>
                  </a>
                </span>
                <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                <span class="links">
                




 <a href='/'>WildGums open source center</a> > Orc.Extensibility

 

   
                </span>
            </div>
            <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#configuring-the-api">Configuring the API</a></li>
<li><a href="#configuring-the-host">Configuring the host</a>
<ul>
<li><a href="#pluginfinder">PluginFinder</a></li>
<li><a href="#finding-and-loading-the-plugins">Finding and loading the plugins</a></li>
</ul></li>
<li><a href="#creating-a-plugin">Creating a plugin</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

          </div>
        
        
        <div id="body-inner">
          
            <h1>Orc.Extensibility</h1>
          






<table>
<thead>
<tr>
<th>Name</th>
<th>Badge</th>
</tr>
</thead>

<tbody>
<tr>
<td>Chat</td>
<td><a href="https://gitter.im/WildGums/Orc.Extensibility?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" target="_blank"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Join the chat at https://gitter.im/WildGums/Orc.Extensibility" /></a></td>
</tr>

<tr>
<td>Downloads</td>
<td><img src="https://img.shields.io/nuget/dt/orc.extensibility.svg" alt="NuGet downloads" /></td>
</tr>

<tr>
<td>Stable version</td>
<td><img src="https://img.shields.io/nuget/v/orc.extensibility.svg" alt="Version" /></td>
</tr>

<tr>
<td>Unstable version</td>
<td><img src="https://img.shields.io/nuget/vpre/orc.extensibility.svg" alt="Pre-release version" /></td>
</tr>
</tbody>
</table>

<p>Find the source at <a href="https://github.com/WildGums/Orc.Extensibility" target="_blank">https://github.com/WildGums/Orc.Extensibility</a></p>

<p>This library provides classes to support pluggable components inside applications (discovery, instantation, etc).</p>

<h2 id="configuring-the-api">Configuring the API</h2>

<p>The API library is the library that exposes the types and interfaces that can be used by any plugin to interact with the host. In most
cases, the API will expose the interface for services which are implemented in the host. In a minimal case, the API will only expose
a type that will be used to recognize a plugin. For example the plugin interface shown below;</p>

<pre><code>public interface ICustomPlugin
{
    Task InitializeAsync();
}
</code></pre>

<h2 id="configuring-the-host">Configuring the host</h2>

<p>The host is responsible for finding and instantiating the plugins.</p>

<h3 id="pluginfinder">PluginFinder</h3>

<p>The library takes care of the hard work. The only thing that it needs to know is whether a type is a plugin. This can be configured
by creating a class deriving from <code>PluginFinderBase</code>:</p>

<pre><code>public class PluginFinder : Orc.Extensibility.PluginFinderBase
{
    private readonly string _pluginName = typeof(ICustomPlugin).Name;

    public PluginFinder(IPluginLocationsProvider pluginLocationsProvider, IPluginInfoProvider pluginInfoProvider,
        IPluginCleanupService pluginCleanupService, IDirectoryService directoryService, IFileService fileService)
        : base(pluginLocationsProvider, pluginInfoProvider, pluginCleanupService, directoryService, fileService)
    {
    }

    protected override bool IsPlugin(Type type)
    {
        // Note: since we are in a reflection-only context here, you can't compare actual types, but need to use string names
        return (from iface in type.GetInterfacesEx()
                where iface.Name.Equals(_pluginName)
                select iface).Any();
    }
}
</code></pre>

<p>Note that it should also be registered in the <code>ServiceLocator</code>:</p>

<pre><code>ServiceLocator.Default.RegisterType&lt;IPluginFinder, PluginFinder&gt;();
</code></pre>

<h3 id="finding-and-loading-the-plugins">Finding and loading the plugins</h3>

<p>It&rsquo;s possible to allow a single plugin host or a multiple plugin host. This example shows how to use the single plugin host:</p>

<pre><code>// In an Orchestra environment, this would go into the bootstrapper
var configurationService = serviceLocator.ResolveType&lt;IConfigurationService&gt;();
var activePlugin = configurationService.GetRoamingValue(ConfigurationKeys.ActivePlugin, ConfigurationKeys.ActivePluginDefaultValue);

var singlePluginService = serviceLocator.ResolveType&lt;ISinglePluginService&gt;();
var plugin = singlePluginService.ConfigureAndLoadPlugin(activePlugin, ConfigurationKeys.ActivePluginDefaultValue);
if (plugin != null)
{
    serviceLocator.RegisterInstance(typeof(ICustomPlugin), plugin.Instance);
}
</code></pre>

<h2 id="creating-a-plugin">Creating a plugin</h2>

<p>Last but not least, plugins will need to be created, but this is extremely easy.</p>

<ol>
<li><p>Create a class library project and reference the API library</p></li>

<li><p>Create a new plugin as shown below:</p>

<pre><code>public class PluginA : ICustomPlugin
{
private readonly IMessageService _messageService;
private readonly IHostService _hostService;

public PluginA(IMessageService messageService, IHostService hostService)
{
    Argument.IsNotNull(() =&gt; messageService);
    Argument.IsNotNull(() =&gt; hostService);

    _messageService = messageService;
    _hostService = hostService;
}

public async Task InitializeAsync()
{
    await _messageService.ShowAsync(&quot;Plugin A has been loaded, setting color to red&quot;);

    _hostService.SetColor(Colors.Red);
}
}
</code></pre></li>

<li><p>Make sure to compile the plugin library and putting it into a location so the host can find it.</p></li>
</ol>


<hr />
<p>
Have a question about WildGums projects? Use <a href="https://stackoverflow.com/questions/tagged/catel" target="_blank">StackOverflow</a> with the <i>Catel</i> tag!
</p>
<hr />
<p>
<h2>Discussion</h2>
<div id="disqus_thread"></div>
<script>
var disqus_config = function () {

this.page.url = 'http://opensource.wildgums.com/\/orc.extensibility\/';

this.page.identifier = 'orc.extensibility\\_index.md';
};
(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://wildgums-opensource.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</p>

<footer class=" footline" >
	
</footer>






        <footer class=" footline" >
	
</footer>
      </div>
    </div>

    
 
    

    <div id="navigation">
        
        
        
    </div>

    </section>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>    

    <script src="/js/clipboard.min.js"></script>
<script src="/js/featherlight.min.js"></script>
<script src="/js/html5shiv-printshiv.min.js"></script>
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="/js/modernizr.custom.71422.js"></script>
<script src="/js/learn.js"></script>
<script src="/js/hugo-learn.js"></script>


<link href="/mermaid/mermaid.css" type="text/css" rel="stylesheet"/>
<script src="/mermaid/mermaid.js"></script>
<script>mermaid.initialize({startOnLoad:true});</script>
    
  </body>
</html>
