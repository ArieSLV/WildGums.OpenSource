<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.25.1" />
    <meta name="description" content="">


    <title>Orc.Memento :: WildGums open source center</title>
    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
    <link href="/css/nucleus.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/hybrid.css" rel="stylesheet">
    <link href="/css/featherlight.min.css" rel="stylesheet">
    <link href="/css/auto-complete.css" rel="stylesheet">
    
    <link href="/css/theme.css" rel="stylesheet">
    
    
    <link href="/css/theme-customization.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <script src="/js/jquery-2.x.min.js"></script>
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left {
        display:none !important;
      }
    </style>

    

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-25600919-4', 'auto');
  ga('send', 'pageview');

</script>
  </head>
  <body class="" data-url="/orc.memento/">
    <nav id="sidebar" class="showVisitedLinks"><div class="highlightable">
  <div id="header-wrapper">
    <div id="header"> 
	<p>WildGums open source center</p>
 


    </div><div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>
<script type="text/javascript" src="/js/lunr.min.js"></script>
<script type="text/javascript" src="/js/auto-complete.js"></script>
<script type="text/javascript">
    var baseurl = "http:\/\/opensource.wildgums.com\/";
</script>
<script type="text/javascript" src="/js/search.js"></script>

  </div>


    <ul class="topics">
            <li data-nav-id="/" class="dd-item">
            <a href="/"><i class="fa fa-fw fa-home"></i></a>
            </li>
    <li data-nav-id="/orc.analytics/" class="dd-item">
      <a href="/orc.analytics/">
        <span>Orc.Analytics</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.automaticsupport/" class="dd-item">
      <a href="/orc.automaticsupport/">
        <span>Orc.AutomaticSupport</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.commandline/" class="dd-item">
      <a href="/orc.commandline/">
        <span>Orc.CommandLine</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/" class="dd-item">
      <a href="/orc.controls/">
        <span>Orc.Controls</span><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </a>
        <ul>
    <li data-nav-id="/orc.controls/animatedgif/" class="dd-item">
      <a href="/orc.controls/animatedgif/">
        <span>AnimatedGif</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/bindablerichtextbox/" class="dd-item">
      <a href="/orc.controls/bindablerichtextbox/">
        <span>BindableRichTextBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/colorlegend/" class="dd-item">
      <a href="/orc.controls/colorlegend/">
        <span>ColorLegend</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/colorpicker/" class="dd-item">
      <a href="/orc.controls/colorpicker/">
        <span>ColorPicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/connectionstringbuilder/" class="dd-item">
      <a href="/orc.controls/connectionstringbuilder/">
        <span>ConnectionStringBuilder</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/culturepicker/" class="dd-item">
      <a href="/orc.controls/culturepicker/">
        <span>CulturePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/datepicker/" class="dd-item">
      <a href="/orc.controls/datepicker/">
        <span>DatePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/daterangepicker/" class="dd-item">
      <a href="/orc.controls/daterangepicker/">
        <span>DateRangePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/datetimepicker/" class="dd-item">
      <a href="/orc.controls/datetimepicker/">
        <span>DateTimePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/dbproviderpicker/" class="dd-item">
      <a href="/orc.controls/dbproviderpicker/">
        <span>DbProviderPicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/directorypicker/" class="dd-item">
      <a href="/orc.controls/directorypicker/">
        <span>DirectoryPicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/dropdownbutton/" class="dd-item">
      <a href="/orc.controls/dropdownbutton/">
        <span>DropDownButton</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/expander/" class="dd-item">
      <a href="/orc.controls/expander/">
        <span>Expander</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/filterbox/" class="dd-item">
      <a href="/orc.controls/filterbox/">
        <span>FilterBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/frameratecounter/" class="dd-item">
      <a href="/orc.controls/frameratecounter/">
        <span>FramerateCounter</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/headerbar/" class="dd-item">
      <a href="/orc.controls/headerbar/">
        <span>HeaderBar</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/linklabel/" class="dd-item">
      <a href="/orc.controls/linklabel/">
        <span>LinkLabel</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/listtextbox/" class="dd-item">
      <a href="/orc.controls/listtextbox/">
        <span>ListTextBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/logviewer/" class="dd-item">
      <a href="/orc.controls/logviewer/">
        <span>LogViewer</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/numerictextbox/" class="dd-item">
      <a href="/orc.controls/numerictextbox/">
        <span>NumericTextBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/openfilepicker/" class="dd-item">
      <a href="/orc.controls/openfilepicker/">
        <span>OpenFilePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/pinnabletooltips/" class="dd-item">
      <a href="/orc.controls/pinnabletooltips/">
        <span>PinnableTooltips</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/savefilepicker/" class="dd-item">
      <a href="/orc.controls/savefilepicker/">
        <span>SaveFilePicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/stackgrid/" class="dd-item">
      <a href="/orc.controls/stackgrid/">
        <span>StackGrid</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/tabcontrol/" class="dd-item">
      <a href="/orc.controls/tabcontrol/">
        <span>TabControl</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/timespanpicker/" class="dd-item">
      <a href="/orc.controls/timespanpicker/">
        <span>TimeSpanPicker</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/validationcontextcontrol/" class="dd-item">
      <a href="/orc.controls/validationcontextcontrol/">
        <span>ValidationContextControl</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.controls/watermarktextbox/" class="dd-item">
      <a href="/orc.controls/watermarktextbox/">
        <span>WatermarkTextBox</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/orc.csvhelper/" class="dd-item">
      <a href="/orc.csvhelper/">
        <span>Orc.CsvHelper</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.csvtexteditor/" class="dd-item">
      <a href="/orc.csvtexteditor/">
        <span>Orc.CsvTextEditor</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.dbtocsv/" class="dd-item">
      <a href="/orc.dbtocsv/">
        <span>Orc.DbToCsv</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.dependencygraph/" class="dd-item">
      <a href="/orc.dependencygraph/">
        <span>Orc.DependencyGraph</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.dynamicobjects/" class="dd-item">
      <a href="/orc.dynamicobjects/">
        <span>Orc.DynamicObjects</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.entityframework/" class="dd-item">
      <a href="/orc.entityframework/">
        <span>Orc.EntityFramework</span><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/orc.entityframework/using-the-dbcontextmanager/" class="dd-item">
        <a href="/orc.entityframework/using-the-dbcontextmanager/">
          <span>Using the DbContextManager</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.entityframework/using-the-repositories-and-unit-of-work/" class="dd-item">
        <a href="/orc.entityframework/using-the-repositories-and-unit-of-work/">
          <span>Using the repositories and unit of work</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.entityframework/using-stored-procedures-and-functions/" class="dd-item">
        <a href="/orc.entityframework/using-stored-procedures-and-functions/">
          <span>Using stored procedures and functions</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.entityframework/using-the-modelbase-as-base-class-for-code-first-entities/" class="dd-item">
        <a href="/orc.entityframework/using-the-modelbase-as-base-class-for-code-first-entities/">
          <span>Using the ModelBase as base class for code-first entities</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/orc.extensibility/" class="dd-item">
      <a href="/orc.extensibility/">
        <span>Orc.Extensibility</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.feedback/" class="dd-item">
      <a href="/orc.feedback/">
        <span>Orc.Feedback</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.fileassociation/" class="dd-item">
      <a href="/orc.fileassociation/">
        <span>Orc.FileAssociation</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.filesystem/" class="dd-item">
      <a href="/orc.filesystem/">
        <span>Orc.FileSystem</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.filterbuilder/" class="dd-item">
      <a href="/orc.filterbuilder/">
        <span>Orc.FilterBuilder</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.fluentvalidation/" class="dd-item">
      <a href="/orc.fluentvalidation/">
        <span>Orc.FluentValidation</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.licensemanager/" class="dd-item">
      <a href="/orc.licensemanager/">
        <span>Orc.LicenseManager</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.logviewer/" class="dd-item">
      <a href="/orc.logviewer/">
        <span>Orc.LogViewer</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.memento/" class="dd-item parent active">
      <a href="/orc.memento/">
        <span>Orc.Memento</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.metadata/" class="dd-item">
      <a href="/orc.metadata/">
        <span>Orc.Metadata</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.notifications/" class="dd-item">
      <a href="/orc.notifications/">
        <span>Orc.Notifications</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.nugetexplorer/" class="dd-item">
      <a href="/orc.nugetexplorer/">
        <span>Orc.NuGetExplorer</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.prism/" class="dd-item">
      <a href="/orc.prism/">
        <span>Orc.Prism</span><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/orc.prism/using-the-bootstrapper/" class="dd-item">
        <a href="/orc.prism/using-the-bootstrapper/">
          <span>Using the bootstrapper</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.prism/declaring-modules/" class="dd-item">
        <a href="/orc.prism/declaring-modules/">
          <span>Declaring modules</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
    <li data-nav-id="/orc.prism/module-catalogs/" class="dd-item">
      <a href="/orc.prism/module-catalogs/">
        <span>Module Catalogs</span><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/orc.prism/module-catalogs/compositemodulecatalog/" class="dd-item">
        <a href="/orc.prism/module-catalogs/compositemodulecatalog/">
          <span>CompositeModuleCatalog</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.prism/module-catalogs/downloadingmodulecatalog/" class="dd-item">
        <a href="/orc.prism/module-catalogs/downloadingmodulecatalog/">
          <span>DownloadingModuleCatalog</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.prism/module-catalogs/nugetbasedmodulecatalog/" class="dd-item">
        <a href="/orc.prism/module-catalogs/nugetbasedmodulecatalog/">
          <span>NuGetBasedModuleCatalog</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
      <li data-nav-id="/orc.prism/module-catalogs/safedirectorymodulecatalog/" class="dd-item">
        <a href="/orc.prism/module-catalogs/safedirectorymodulecatalog/">
          <span>SafeDirectoryModuleCatalog</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
        </ul>
    </li>
      <li data-nav-id="/orc.prism/translating-or-customizing/" class="dd-item">
        <a href="/orc.prism/translating-or-customizing/">
          <span>Translating or customizing</span><i class="fa fa-circle-thin read-icon"></i>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/orc.projectmanagement/" class="dd-item">
      <a href="/orc.projectmanagement/">
        <span>Orc.ProjectManagement</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.scheduling/" class="dd-item">
      <a href="/orc.scheduling/">
        <span>Orc.Scheduling</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.search/" class="dd-item">
      <a href="/orc.search/">
        <span>Orc.Search</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.skia/" class="dd-item">
      <a href="/orc.skia/">
        <span>Orc.Skia</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.snapshots/" class="dd-item">
      <a href="/orc.snapshots/">
        <span>Orc.Snapshots</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.sort/" class="dd-item">
      <a href="/orc.sort/">
        <span>Orc.Sort</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.squirrel/" class="dd-item">
      <a href="/orc.squirrel/">
        <span>Orc.Squirrel</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.supportpackage/" class="dd-item">
      <a href="/orc.supportpackage/">
        <span>Orc.SupportPackage</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.systeminfo/" class="dd-item">
      <a href="/orc.systeminfo/">
        <span>Orc.SystemInfo</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.wizard/" class="dd-item">
      <a href="/orc.wizard/">
        <span>Orc.Wizard</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orc.workspacemanagement/" class="dd-item">
      <a href="/orc.workspacemanagement/">
        <span>Orc.WorkspaceManagement</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
    <li data-nav-id="/orchestra/" class="dd-item">
      <a href="/orchestra/">
        <span>Orchestra</span><i class="fa fa-circle-thin read-icon"></i>
      </a>
    </li>
        <section id="shortcuts">
                <li class="" role=""><h3>More</h3><a href="https://github.com/wildgums/wildgums.opensource" target="_blank" rel="noopener"><i class='fa fa-github'></i> Github repo</a></li>
        </section>
            <a class="" href="#" data-clear-history-toggle=""><i class="fa  fa-history"></i> Clear History</a>
    </ul>


    <section id="footer"><center>

<a class="github-button" href="https://github.com/catel/catel/archive/master.zip" data-icon="octicon-cloud-download" aria-label="Download Catel on GitHub">Download</a>


<a class="github-button" href="https://github.com/catel/catel" data-icon="octicon-star" data-show-count="false" aria-label="Star Catel on GitHub">Star</a>


<a class="github-button" href="https://github.com/catel/catel/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork Catel on GitHub">Fork</a>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </div>
</nav>



        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
        
          <div id="top-bar">
            
              
              
              
            <div id="top-github-link">
              <a class="github-link" href="https://github.com/wildgums/wildgums.opensource/edit/master/src/content/orc.memento/_index.md" target="blank">
                <i class="fa fa-code-fork"></i>
                Edit page
              </a>
            </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                <span id="sidebar-toggle-span">
                  <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                    <i class="fa fa-bars"></i>
                  </a>
                </span>
                <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                <span class="links">
                




 <a href='/'>WildGums open source center</a> > Orc.Memento

 

   
                </span>
            </div>
            <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#undo-and-redo-support">Undo and redo support</a></li>
<li><a href="#grouping-actions-in-batches">Grouping actions in batches</a></li>
<li><a href="#ignoring-support-for-memento">Ignoring support for memento</a></li>
</ul></li>
<li><a href="#memento-and-properties">Memento and properties</a>
<ul>
<li><a href="#handling-property-changes-automatically">Handling property changes automatically</a></li>
<li><a href="#handling-property-changes-manually">Handling property changes manually</a></li>
<li><a href="#removing-an-object-and-its-actions">Removing an object and its actions</a></li>
</ul></li>
<li><a href="#memento-and-collections">Memento and collections</a>
<ul>
<li><a href="#handling-collection-changes-automatically">Handling collection changes automatically</a></li>
<li><a href="#handling-collection-changes-manually">Handling collection changes manually</a></li>
<li><a href="#removing-a-collection-and-its-actions">Removing a collection and its actions</a></li>
</ul></li>
<li><a href="#memento-and-methods">Memento and methods</a>
<ul>
<li><a href="#handling-methods-manually">Handling methods manually</a></li>
<li><a href="#removing-the-actions-from-the-undo-redo-stack">Removing the actions from the undo/redo stack</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

          </div>
        
        
        <div id="body-inner">
          
            <h1>Orc.Memento</h1>
          






<table>
<thead>
<tr>
<th>Name</th>
<th>Badge</th>
</tr>
</thead>

<tbody>
<tr>
<td>Chat</td>
<td><a href="https://gitter.im/WildGums/Orc.Memento?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Join the chat at https://gitter.im/WildGums/Orc.Memento" /></a></td>
</tr>

<tr>
<td>Downloads</td>
<td><img src="https://img.shields.io/nuget/dt/orc.memento.svg" alt="NuGet downloads" /></td>
</tr>

<tr>
<td>Stable version</td>
<td><img src="https://img.shields.io/nuget/v/orc.memento.svg" alt="Version" /></td>
</tr>

<tr>
<td>Unstable version</td>
<td><img src="https://img.shields.io/nuget/vpre/orc.memento.svg" alt="Pre-release version" /></td>
</tr>
</tbody>
</table>

<p>Find the source at <a href="https://github.com/WildGums/Orc.Memento">https://github.com/WildGums/Orc.Memento</a></p>

<h1 id="introduction">Introduction</h1>

<p>Lots of real world applications need to implement undo/redo. However, most applications written in MVVM lack this feature because it is very hard to implement. Luckily, Catel solves this issue by introducing the <code>IMementoService</code>. The <code>IMementoService</code> is a service that allows a developer to register custom actions that should be undone. A few actions you can think of:</p>

<ul>
<li>Property change of a model</li>
<li>Item is added or removed to/from a collection</li>
<li>A method is executed</li>
</ul>

<p>One way to introduce the memento pattern is by creating a copy of the whole memory at each step (yes, some people actually do this), but in Catel it is done a bit smarter. For each possible action type, there is an implementation of the <code>UndoBase</code>. This way, each action will know by itself how to undo or redo. Catel offers the following default implementations:</p>

<ul>
<li>PropertyChangeUndo</li>
<li>CollectionChangeUndo</li>
<li>ActionUndo</li>
</ul>

<p>If there are more actions supported, it is possible to write a custom <code>UndoBase</code> implementation and add the specific action to the <code>IMementoService</code>. It will automatically be added to the undo/redo action stack.</p>

<h2 id="undo-and-redo-support">Undo and redo support</h2>

<p>The <code>IMementoService</code> supports both undo and redo actions. This means that an action that is undo-ed by a call to the <code>Undo</code> method, it is automatically added to the redo stack when redo is supported.</p>

<p>To undo an action, use the code below:</p>

<pre><code>var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
mementoService.Undo();
</code></pre>

<p>It is possible to check whether it is possible to undo actions by using the <code>CanUndo</code> property. This check is not required since the <code>Undo</code> method will also check this internally.</p>

<p>To redo an action, use the code below:</p>

<pre><code>var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
mementoService.Redo();
</code></pre>

<p>It is possible to check whether it is possible to redo actions by using the <code>CanRedo</code> property. This check is not required since the <code>Redo</code> method will also check this internally.</p>

<h2 id="grouping-actions-in-batches">Grouping actions in batches</h2>

<p>The <code>MementoService</code> automatically wraps all actions in batches. Because each action is treated as a batch, it is easy to begin a batch and add several actions to a single batch. Below is the code to create a batch:</p>

<pre><code>var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
mementoService.BeginBatch(&quot;Batch title&quot;, &quot;Batch description&quot;);
 
// All actions added to the memento service are added to the specified batch
</code></pre>

<p><em>Note that the Title and Description are optional. They are however a great way to represent the batches in the user interface</em></p>

<p>A batch can be ended in several ways:</p>

<ol>
<li>A call to EndBatch</li>
<li>A call to BeginBatch</li>
</ol>

<p>As soon as a batch is ended by one of the ways described above, it will be added to the undo stack.</p>

<h2 id="ignoring-support-for-memento">Ignoring support for memento</h2>

<p>Ignoring specific properties or methods for the IMementoService is very easy. Just decorate them with the IgnoreMementoSupportAttribute as shown below:</p>

<pre><code>[IgnoreMementoSupport]
public string IgnoredProperty { get; set; }
</code></pre>

<h1 id="memento-and-properties">Memento and properties</h1>

<p>Adding the ability to undo and redo property changes on an object is very simple using the <code>PropertyChangeUndo</code> class. This can be done either automatically or manually.</p>

<h2 id="handling-property-changes-automatically">Handling property changes automatically</h2>

<p>When an object implements the <code>INotifyPropertyChanged</code> interface, it is possible to register the object. The <code>IMementoService</code> will fully take care of any property changes by the object and add these automatically to the undo/redo stack. Internally, the service will create an instance of the <code>ObjectObserver</code> which will register the changes in the <code>IMementoService</code>.</p>

<pre><code>var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
mementoService.RegisterObject(myObject);
</code></pre>

<h2 id="handling-property-changes-manually">Handling property changes manually</h2>

<p>When an object does not support the <code>INotifyPropertyChanged</code> interface or you want more control, it is possible to instantiate the <code>PropertyChangeUndo</code> yourself. See the example below:</p>

<pre><code>public string Name
{
    get { return _name; }
    set
    {
        object oldValue = _name;
        object newValue = value;
 
        _name = value;
 
        RaisePropertyChanged(&quot;Name&quot;);
 
        var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
        mementoService.Add(new PropertyChangeUndo(this, &quot;Name&quot;, oldValue, newValue)); 
    }
}
</code></pre>

<h2 id="removing-an-object-and-its-actions">Removing an object and its actions</h2>

<p>When a model goes out of scope, it is important that the <code>IMementoService</code> does not keep it in memory and keeps undoing the changes. Therefore, one should also unregister the object:</p>

<pre><code>var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
mementoService.UnregisterObject(myObject);
</code></pre>

<p><em>Note that unregistering an object will both cancel change notifications and remove the actions that belong to this object from the undo/redo stack</em></p>

<h1 id="memento-and-collections">Memento and collections</h1>

<p>Adding the ability to undo and redo collection changes on a collection is very simple using the <code>CollectionChangeUndo</code> class. This can be done either automatically or manually.</p>

<h2 id="handling-collection-changes-automatically">Handling collection changes automatically</h2>

<p>When a collection implements the <code>INotifyCollectionChanged</code> interface, it is possible to register the collection. The <code>IMementoService</code> will fully take care of any collection changes by the collection and add these automatically to the undo/redo stack. Internally, the service will create an instance of the <code>CollectionObserver</code> which will register the changes in the <code>IMementoService</code>.</p>

<pre><code>var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
mementoService.RegisterCollection(myCollection);
</code></pre>

<h2 id="handling-collection-changes-manually">Handling collection changes manually</h2>

<p>When an object does not support the <code>INotifyCollectionChanged</code> interface or you want more control, it is possible to instantiate the <code>CollectionChangeUndo</code> yourself. See the example below:</p>

<pre><code>public void AddPerson(IPerson person)
{
    var newIndex = _internalCollection.Add(person);
     
    var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
    mementoService.Add(new CollectionChangeUndo(_internalCollection, CollectionChangeType.Add, -1, newIndex, null, item)); 
}
</code></pre>

<p><em>Note that all actions should be implemented, such as adding, replacing, removing and resetting to fully support undo/redo</em></p>

<h2 id="removing-a-collection-and-its-actions">Removing a collection and its actions</h2>

<p>When a collection goes out of scope, it is important that the <code>IMementoService</code> does not keep it in memory and keeps undoing the changes. Therefore, one should also unregister the collection:</p>

<pre><code>var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
mementoService.UnregisterCollection(myCollection);
</code></pre>

<p><em>Note that unregistering a collection will both cancel change notifications and remove the actions that belong to this collection from the undo/redo stack</em></p>

<h1 id="memento-and-methods">Memento and methods</h1>

<p>Adding the ability to undo and redo methods is the most complex, because this cannot be done automatically. However, it is possible to use the <code>ActionUndo</code> class to make it as easy as possible.</p>

<h2 id="handling-methods-manually">Handling methods manually</h2>

<p>An action can come in two flavors. One with only undo support, and one with redo support. It is always recommended to implement the one with support for redo, but the choice is always yours. For this example, let&rsquo;s assume a simple class that will increase a value (for which we are building undo/redo support):</p>

<pre><code>public class SpecialNumberContainer()
{
    private int _number = 5;
     
    public int Number { get { return _number; } }
     
    public int IncreaseNumber()
    {
        _number++;
    }
}
</code></pre>

<p>As you can see in the example, it is not possible to use the <code>PropertyChangeUndo</code> because the property has no setter and no change notification. So, we will create custom actions for undo/redo.</p>

<p>First, the class with only undo support:</p>

<pre><code>public class SpecialNumberContainer()
{
    private int _number = 5;
 
    public int Number { get { return _number; } }
     
    public int IncreaseNumber()
    {
        _number++;
         
        var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
        mementoService.Add(new ActionUndo(this, () =&gt; _number--)); 
    }
}
</code></pre>

<p>The code above will add a new action to the undo stack every time the <code>IncreaseNumber</code> method is called. Then, it will not add it to the redo stack because redo is not possible (we haven&rsquo;t provided a redo action).</p>

<p>Below is the same class, but now with redo support:</p>

<pre><code>public class SpecialNumberContainer()
{
    private int _number = 5;
 
    public int Number { get { return _number; } }
     
    public int IncreaseNumber()
    {
        _number++;
         
        var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
        mementoService.Add(new ActionUndo(this, () =&gt; _number--, () =&gt; _number++)); 
    }
}
</code></pre>

<p>The code above will add a new action to the undo stack every time the <code>IncreaseNumber</code> method is called. Then, when an action is undo-ed, the action is added to the redo stack and it is possible to redo the action because the redo action was provided as well.</p>

<h2 id="removing-the-actions-from-the-undo-redo-stack">Removing the actions from the undo/redo stack</h2>

<p>When an action no longer has to be in the undo/redo stack of the <code>IMementoService</code>, one should call the <code>Clear</code> method with the instance of the method as shown in the sample below:</p>

<pre><code>var mementoService = ServiceLocator.Default.ResolveType&lt;IMementoService&gt;();
mementoService.Clear(myInstanceContainingTheMethod);
</code></pre>


<hr />
<p>
Have a question about WildGums projects? Use <a href="https://stackoverflow.com/questions/tagged/catel" target="_blank">StackOverflow</a> with the <i>Catel</i> tag!
</p>
<hr />
<p>
<h2>Discussion</h2>
<div id="disqus_thread"></div>
<script>
var disqus_config = function () {

this.page.url = 'http://opensource.wildgums.com/\/orc.memento\/';

this.page.identifier = 'orc.memento\\_index.md';
};
(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://wildgums-opensource.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</p>

<footer class=" footline" >
	
</footer>






        

      </div>
    </div>

    
 
    

    <div id="navigation">
        
        
        
    </div>

    </section>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>    

    <script src="/js/clipboard.min.js"></script>
<script src="/js/featherlight.min.js"></script>
<script src="/js/html5shiv-printshiv.min.js"></script>
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="/js/modernizr.custom.71422.js"></script>
<script src="/js/learn.js"></script>
<script src="/js/hugo-learn.js"></script>


<link href="/mermaid/mermaid.css" type="text/css" rel="stylesheet"/>
<script src="/mermaid/mermaid.js"></script>
<script>mermaid.initialize({startOnLoad:true});</script>
    

  </body>
</html>
