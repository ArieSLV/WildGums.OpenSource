<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Introduction - WildGums open source center</title>
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../css/theme_colors.css" type="text/css" />
    <link rel="stylesheet" href="../css/styles/vs.css">
    <link rel="stylesheet" href="../css/font-awesome.4.5.0.min.css">
</head>
<body role="document">
    <div class="grid-for-nav">
        <nav data-toggle="nav-shift" class="nav-side stickynav">
            <div class="side-nav-search">
                <a href="/index.htm"><i class="fa fa-home"></i> WildGums open source center</a>
                <div role="search">
                    <form id="search-form" class="form" action="../Docnet_search.htm" method="get">
                        <input type="text" name="q" placeholder="Search docs" />
                    </form>
                </div>
            </div>
            <div class="menu menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
<ul>
<li class="tocentry"><a href="../Home.htm">Home</a>
</li>
<li class="tocentry"><a href="../introduction.htm">Introduction</a>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../Orchestra.htm">Orchestra</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcAnalytics.htm">Orc.Analytics</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcAutomaticSupport.htm">Orc.AutomaticSupport</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcCommandLine.htm">Orc.CommandLine</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcControls.htm">Orc.Controls</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcCsvHelper.htm">Orc.CsvHelper</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcDependencyGraph.htm">Orc.DependencyGraph</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcDynamicObjects.htm">Orc.DynamicObjects</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcEntityFramework.htm">Orc.EntityFramework</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcExtensibility.htm">Orc.Extensibility</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcFeedback.htm">Orc.Feedback</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcFileAssociation.htm">Orc.FileAssociation</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcFileSystem.htm">Orc.FileSystem</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcFilterBuilder.htm">Orc.FilterBuilder</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcFluentValidation.htm">Orc.FluentValidation</a></span>
</li>
<li class="tocentry">
<ul>
<li><span class="navigationgroup"><i class="fa fa-caret-down"></i> <a href="../OrcLicenseManager.htm">Orc.LicenseManager</a></span></li>
<li class="tocentry current"><a class="current" href="../orc.licensemanager/introduction.htm">Introduction</a>
<ul class="currentrelative">
<li class="tocentry"><a href="#the-basics">The basics</a></li>
<li class="tocentry"><a href="#validating-a-license-locally">Validating a license locally</a></li>
<li class="tocentry"><a href="#validating-a-license-online">Validating a license online</a></li>
<li class="tocentry"><a href="#validating-the-number-of-licenses-used-on-the-network">Validating the number of licenses used on the network</a></li>
</ul>

</ul>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcLogViewer.htm">Orc.LogViewer</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcMemento.htm">Orc.Memento</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcMetadata.htm">Orc.Metadata</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcNotifications.htm">Orc.Notifications</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcNuGetExplorer.htm">Orc.NuGetExplorer</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcPrism.htm">Orc.Prism</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcProjectManagement.htm">Orc.ProjectManagement</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcScheduling.htm">Orc.Scheduling</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcSearch.htm">Orc.Search</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcSkia.htm">Orc.Skia</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcSnapshots.htm">Orc.Snapshots</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcSort.htm">Orc.Sort</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcSquirrel.htm">Orc.Squirrel</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcSupportPackage.htm">Orc.SupportPackage</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcSystemInfo.htm">Orc.SystemInfo</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcWizard.htm">Orc.Wizard</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../OrcWorkspaceManagement.htm">Orc.WorkspaceManagement</a></span>
</li>

</ul>
				<div class="toc-footer">
					<span class="text-small">
						<hr/>
						<a href="https://github.com/FransBouma/DocNet" target="_blank">Made with <i class="fa fa-github"></i> DocNet</a>
					</span>
				</div>	
			</div>
            &nbsp;
        </nav>
        <section data-toggle="nav-shift" class="nav-content-wrap">
            <nav class="nav-top" role="navigation" aria-label="top navigation">
                <i data-toggle="nav-top" class="fa fa-bars"></i>
                <a href="../index.htm">WildGums open source center</a>
            </nav>
            <div class="nav-content">
                <div role="navigation" aria-label="breadcrumbs navigation">
                    <div class="breadcrumbs">
<ul><li><a href="../Home.htm">Home</a></li> / <li><a href="../OrcLicenseManager.htm">Orc.LicenseManager</a></li> / <li><a href="../orc.licensemanager/introduction.htm">Introduction</a></li></ul>

                    </div>
                    <hr />
                </div>
                <div role="main">
                    <div class="section">
<h1 id="orc.licensemanager">Orc.LicenseManager<a class="headerlink" href="#orc.licensemanager" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h1>
<table class="table table-bordered-all table-responsive">
<thead>
<tr>
	<th>Name</th>
	<th>Badge</th>
</tr>
</thead>
<tbody>
<tr>
	<td>Chat</td>
	<td><a href="https://gitter.im/WildGums/Orc.LicenseManager?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" target="_blank"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Join the chat at https://gitter.im/WildGums/Orc.LicenseManager" /></a></td>
</tr>
<tr>
	<td>Downloads</td>
	<td><img src="https://img.shields.io/nuget/dt/orc.licensemanager.client.svg" alt="NuGet downloads" /></td>
</tr>
<tr>
	<td>Stable version</td>
	<td><img src="https://img.shields.io/nuget/v/orc.licensemanager.client.svg" alt="Version" /></td>
</tr>
<tr>
	<td>Unstable version</td>
	<td><img src="https://img.shields.io/nuget/vpre/orc.licensemanager.client.svg" alt="Pre-release version" /></td>
</tr>
</tbody>
</table>
<p>This library makes it very easy to manage licenses for commercial software.</p>
<h1 id="client-validation">Client validation<a class="headerlink" href="#client-validation" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h1>
<p>Internally the license manager uses <a href="https://github.com/dnauck/Portable.Licensing" target="_blank">Portable.Licensing</a>. This is a wrapper around both the server and client to make it very easy to implement license validations.</p>
<h2 id="the-basics">The basics<a class="headerlink" href="#the-basics" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>To check a license on the client, we need the public key of the application. It is very important to keep the private key private on the server.</p>
<p>It is a good practice to create a <em>License</em> class to contain all this information:</p>
<pre><code>public static class License
{
    // The public key of the product
    public const string ApplicationId = &quot;MIIBKjCB4wYHKoZI.....&quot;;

    public const string LicenseServer = &quot;https://www.myserver.com/api/license&quot;;
}
</code></pre>

<h2 id="validating-a-license-locally">Validating a license locally<a class="headerlink" href="#validating-a-license-locally" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>The first thing that needs to be done is to validate locally. If the license is not valid, the software will automatically show a license dialog.</p>
<pre><code>if (!await _simpleLicenseService.Validate(License.ApplicationId, &quot;My Product&quot;, &quot;/MyProduct;component/Resources/Images/logo_0128.png&quot;, &quot;In order to use this software, a license is required.&quot;)())
{
    // License is not valid, exit software
}
</code></pre>

<h2 id="validating-a-license-online">Validating a license online<a class="headerlink" href="#validating-a-license-online" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>It is also possible to check the license on the server as well.</p>
<pre><code>if (!await _simpleLicenseService.ValidateOnServer(License.LicenseServer, License.ApplicationId, &quot;My Product&quot;, &quot;/MyProduct;component/Resources/Images/logo_0128.png&quot;, &quot;In order to use this software, a license is required.&quot;)())
{
    // License is not valid, exit software
}
</code></pre>

<h2 id="validating-the-number-of-licenses-used-on-the-network">Validating the number of licenses used on the network<a class="headerlink" href="#validating-the-number-of-licenses-used-on-the-network" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>The software can detect the number of licenses used on the current network. It does this by sending UDP broadcast packages over the network with the license signature. All software using the specified license will reply with the IP and the date/time they started using the license. This way it's possible to list all usages and kick out the latest user.</p>
<h3 id="initialize">Initialize<a class="headerlink" href="#initialize" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h3>
<p>The easiest way to use the <em>INetworkLicenseService</em> is to initialize it with a polling value. Then it will automatically raise events when a validation has occurred.</p>
<pre><code>_networkLicenseService.Validated += OnNetworkLicenseValidated;
await _networkLicenseService.Initialize(TimeSpan.FromSeconds(30));
</code></pre>

<p>Then you can handle the result of the validation in the event handler:</p>
<pre><code>private async void OnNetworkLicenseValidated(object sender, NetworkValidatedEventArgs e)
{
    var validationResult = e.ValidationResult;
    if (!validationResult.IsValid)
    {
        var latestUsage = (from usage in validationResult.CurrentUsers
                            orderby usage.StartDateTime descending
                            select usage).First();

        if (string.Equals(_networkLicenseService.ComputerId, latestUsage.ComputerId))
        {
            await _messageService.Show(string.Format(&quot;License is invalid, using '{0}' of '{1}' licenses. You are the latest user, your software will be shut down&quot;, validationResult.CurrentUsers.Count, validationResult.MaximumConcurrentUsers));                    
        }
        else
        {
            await _messageService.Show(string.Format(&quot;License is invalid, using '{0}' of '{1}' licenses. The latest user is '{2}' with ip '{3}', you can continue working&quot;, validationResult.CurrentUsers.Count, validationResult.MaximumConcurrentUsers, latestUsage.ComputerId, latestUsage.Ip));
        }
    }
}
</code></pre>

<h3 id="manually-validating-the-network">Manually validating the network<a class="headerlink" href="#manually-validating-the-network" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h3>
<p>To manually perform a check, use the following code:</p>
<pre><code>var validationResult = await _networkLicenseService.Validate();
</code></pre>

<h1 id="server-validation">Server validation<a class="headerlink" href="#server-validation" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h1>
<p>[server documentation must be written yet]</p>

                    </div>
                </div>
                <footer>
                    <hr />
                    <div role="contentinfo">

                      <p>
					    Is this section not up-to-date or found an issue? Please <a href="https://github.com/wildgums/wildgums.opensource/blob/master/src/orc.licensemanager/introduction.md" target="_blank">contribute</a>!
					  </p>
					  <p>
					    Have a question about WildGums projects? Use <a href="https://stackoverflow.com/questions/tagged/catel" target="_blank">StackOverflow</a> with the <i>Catel</i> tag!
					  </p>
					  <hr />
					  <p>
					    <h2>Discussion</h2>
					   <div id="disqus_thread"></div>
					   <script>
					   var disqus_config = function () {
					   this.page.url = 'http://opensource.wildgums.com/orc.licensemanager/introduction.htm';
					   this.page.identifier = 'src/orc.licensemanager/introduction.md';
					   };
					   (function() { // DON'T EDIT BELOW THIS LINE
					   var d = document, s = d.createElement('script');
					   s.src = 'https://wildgums-opensource.disqus.com/embed.js';
					   s.setAttribute('data-timestamp', +new Date());
					   (d.head || d.body).appendChild(s);
					   })();
					   </script>
					   <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
					  </p>
					</div>
                </footer>
            </div>
        </section>
    </div>
    <script src="../js/jquery-2.1.1.min.js"></script>
    <script src="../js/modernizr-2.8.3.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script src="../js/theme.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    
      ga('create', 'UA-54671533-18', 'auto');
      ga('send', 'pageview');
    
    </script>
</body>
</html>
